#!/bin/bash
# 404 에러 디버깅 스크립트
# EC2에서 실행하세요

echo "========================================="
echo "1. 백엔드 서비스 상태 확인"
echo "========================================="
sudo systemctl status studylink

echo ""
echo "========================================="
echo "2. 백엔드 로그 확인 (최근 50줄)"
echo "========================================="
sudo journalctl -u studylink -n 50 --no-pager

echo ""
echo "========================================="
echo "3. 6080 포트 리스닝 확인"
echo "========================================="
sudo netstat -tulpn | grep 6080

echo ""
echo "========================================="
echo "4. Nginx 상태 확인"
echo "========================================="
sudo systemctl status nginx

echo ""
echo "========================================="
echo "5. Nginx 설정 테스트"
echo "========================================="
sudo nginx -t

echo ""
echo "========================================="
echo "6. Nginx 에러 로그 (최근 20줄)"
echo "========================================="
sudo tail -20 /var/log/nginx/error.log

echo ""
echo "========================================="
echo "7. Nginx access 로그 (최근 20줄)"
echo "========================================="
sudo tail -20 /var/log/nginx/access.log

echo ""
echo "========================================="
echo "8. localhost:6080 직접 테스트"
echo "========================================="
curl -v http://localhost:6080/user/info

echo ""
echo "========================================="
echo "9. Nginx 설정 파일 확인"
echo "========================================="
cat /etc/nginx/sites-available/api.studylink.store

echo ""
echo "========================================="
echo "10. 심볼릭 링크 확인"
echo "========================================="
ls -la /etc/nginx/sites-enabled/

echo ""
echo "========================================="
echo "디버깅 완료!"
echo "========================================="
